{% extends "layout.html" %}
{% block content %}
<div class="card">
  <div class="card-content">
    <h2 class="title is-4 mb-4">Settings</h2>
    <form id="settingsForm">
      <div class="field mb-4">
        <label class="label">Primary Color</label>
        <input type="color" id="primaryColor" class="input">
      </div>
      <div class="field mb-4">
        <label class="label">Highlight Color</label>
        <input type="color" id="highlightColor" class="input">
      </div>
      <div class="field mb-4">
        <label class="label" for="darkMode">Dark Mode</label>
        <input type="checkbox" id="darkMode" class="switch is-rounded">
      </div>
      <div class="field mb-4">
        <label class="label" for="fontSize">Base Font Size</label>
        <input type="range" id="fontSize" min="0.8" max="1.2" step="0.05">
      </div>
      <div class="buttons">
        <button type="submit" class="button is-primary">Save</button>
        <button type="button" id="resetBtn" class="button is-light">Reset</button>
      </div>
    </form>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const root = document.documentElement;
    const primaryInput = document.getElementById('primaryColor');
    const highlightInput = document.getElementById('highlightColor');
    const darkInput = document.getElementById('darkMode');
    const fontInput = document.getElementById('fontSize');
    function load() {
      const cp = localStorage.getItem('ultra-primary') || getComputedStyle(root).getPropertyValue('--ultra-primary').trim();
      const ch = localStorage.getItem('ultra-highlight') || getComputedStyle(root).getPropertyValue('--ultra-highlight').trim();
      const dm = localStorage.getItem('ultra-dark') === '1';
      const fs = localStorage.getItem('ultra-font-size') || getComputedStyle(root).getPropertyValue('--base-font-size').trim();
      primaryInput.value = cp;
      highlightInput.value = ch;
      darkInput.checked = dm;
      fontInput.value = parseFloat(fs);
    }
    function apply() {
      root.style.setProperty('--ultra-primary', primaryInput.value);
      root.style.setProperty('--ultra-highlight', highlightInput.value);
      root.style.setProperty('--base-font-size', fontInput.value + 'rem');
      document.body.classList.toggle('dark-mode', darkInput.checked);
    }
    load();
    apply();
    document.getElementById('settingsForm').addEventListener('submit', function(e) {
      e.preventDefault();
      localStorage.setItem('ultra-primary', primaryInput.value);
      localStorage.setItem('ultra-highlight', highlightInput.value);
      localStorage.setItem('ultra-dark', darkInput.checked ? '1' : '0');
      localStorage.setItem('ultra-font-size', fontInput.value + 'rem');
      apply();
    });
    document.getElementById('resetBtn').addEventListener('click', function() {
      localStorage.removeItem('ultra-primary');
      localStorage.removeItem('ultra-highlight');
      localStorage.removeItem('ultra-dark');
      localStorage.removeItem('ultra-font-size');
      load();
      apply();
    });
  });
</script>
{% endblock %}
