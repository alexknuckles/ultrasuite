{% extends "layout.html" %}
{% block content %}
<div class="mdc-card page-card">
  <div class="card-content">
    <h2 class="title is-4 mb-4">Settings</h2>
    <nav class="buttons tab-buttons mb-4" id="settingsTabs">
      <button type="button" class="mdc-button mdc-button--raised is-active" data-target="generalSettings">General</button>
      <button type="button" class="mdc-button mdc-button--raised" data-target="exportSettings">Export</button>
    </nav>
    <form method="post" enctype="multipart/form-data">
    <div id="generalSettings" class="tab-pane">
    </div>
    <div id="exportSettings" class="tab-pane is-hidden">
      <div class="field mb-4">
        <label class="label">Branding text (optional)</label>
        <input class="input" type="text" name="branding" value="{{ branding }}">
      </div>
      <div class="field mb-4">
        <label class="label">Report title (optional)</label>
        <input class="input" type="text" name="report_title" value="{{ report_title }}">
      </div>
      <div class="field mb-4">
        <label class="label">Branding logo</label>
        {% if logo_path %}
        <img src="{{ url_for('branding_logo') }}" alt="logo" style="max-height:3rem;" class="mb-2">
        {% endif %}
        <input class="input" type="file" name="logo" accept="image/*">
      </div>
      <div class="field mb-4">
        <label class="label">Primary color</label>
        <input class="input" type="color" name="primary_color" value="{{ primary_color }}">
      </div>
      <div class="field mb-4">
        <label class="label">Highlight color</label>
        <input class="input" type="color" name="highlight_color" value="{{ highlight_color }}">
      </div>
      <div class="field mb-4">
        <label class="label">Default month for exports</label>
        <div class="select">
          <select name="default_month">
            <option value="" {% if not default_month %}selected{% endif %}>Last full month</option>
            {% for m in months %}
            <option value="{{ m.num }}" {% if m.num == default_month %}selected{% endif %}>{{ m.name }}</option>
            {% endfor %}
          </select>
        </div>
      </div>
      <h3 class="title is-5">Monthly reports</h3>
      <div class="field mb-4">
        <label class="checkbox">
          <input type="checkbox" name="include_month_summary" {% if include_month_summary %}checked{% endif %}>
          Last full month by sales type
        </label>
      </div>
      <div class="field mb-4">
        <label class="checkbox">
          <input type="checkbox" name="include_month_details" {% if include_month_details %}checked{% endif %}>
          Detailed by type
        </label>
      </div>
      <h3 class="title is-5 mt-4">Yearly reports</h3>
      <div class="field mb-4">
        <label class="checkbox">
          <input type="checkbox" name="include_year_overall" {% if include_year_overall %}checked{% endif %}>
          Overall sales by month
        </label>
      </div>
      <div class="field mb-4">
        <label class="checkbox">
          <input type="checkbox" name="include_year_summary" {% if include_year_summary %}checked{% endif %}>
          Yearly summary by type
        </label>
      </div>
    </div>
      <button type="submit" class="mdc-button mdc-button--raised">Save</button>
    </form>
  </div>
</div>
<script>
  document.querySelectorAll('#settingsTabs button').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('#settingsTabs button').forEach(b => b.classList.remove('is-active'));
      btn.classList.add('is-active');
      document.querySelectorAll('.tab-pane').forEach(p => p.classList.add('is-hidden'));
      document.getElementById(btn.dataset.target).classList.remove('is-hidden');
    });
  });
</script>
{% endblock %}
