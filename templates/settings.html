{% extends "layout.html" %}
{% block content %}
<div class="card">
  <div class="card-content">
    <h2 class="title is-4 mb-4">Settings</h2>
    <form id="settingsForm">
      <h3 class="title is-5 mb-2">Appearance</h3>
      <div class="field mb-4">
        <label class="label">Theme</label>
        <div class="select is-fullwidth">
          <select id="themeSelect">
            <option value="default">Default</option>
            <option value="ocean">Ocean</option>
            <option value="sunset">Sunset</option>
            <option value="forest">Forest</option>
          </select>
        </div>
      </div>
      <div class="field mb-4">
        <label class="label" for="darkMode">Dark Mode</label>
        <input type="checkbox" id="darkMode" class="switch is-rounded">
      </div>
      <div class="buttons">
        <button type="submit" class="button is-primary">Save</button>
        <button type="button" id="resetBtn" class="button is-light">Reset</button>
      </div>
    </form>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const root = document.documentElement;
    const themeSelect = document.getElementById('themeSelect');
    const darkInput = document.getElementById('darkMode');
    const THEMES = {
      default: { primary: '#5e4e69', highlight: '#e6e4e8' },
      ocean: { primary: '#1976d2', highlight: '#bbdefb' },
      sunset: { primary: '#d84315', highlight: '#ffe0b2' },
      forest: { primary: '#2e7d32', highlight: '#c8e6c9' }
    };
    function load() {
      const themeName = localStorage.getItem('ultra-theme') || 'default';
      themeSelect.value = themeName;
      const dm = localStorage.getItem('ultra-dark') === '1';
      applyTheme(themeName);
      darkInput.checked = dm;
      document.body.classList.toggle('dark-mode', dm);
    }
    function applyTheme(name) {
      const t = THEMES[name] || THEMES.default;
      root.style.setProperty('--ultra-primary', t.primary);
      root.style.setProperty('--ultra-highlight', t.highlight);
    }
    function apply() {
      applyTheme(themeSelect.value);
      document.body.classList.toggle('dark-mode', darkInput.checked);
    }
    load();
    document.getElementById('settingsForm').addEventListener('submit', function(e) {
      e.preventDefault();
      localStorage.setItem('ultra-theme', themeSelect.value);
      localStorage.setItem('ultra-dark', darkInput.checked ? '1' : '0');
      apply();
    });
    document.getElementById('resetBtn').addEventListener('click', function() {
      localStorage.removeItem('ultra-theme');
      localStorage.removeItem('ultra-dark');
      load();
    });
  });
</script>
{% endblock %}
